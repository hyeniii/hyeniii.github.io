<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Fraud detection model pipeline | Hye Won (Nicole) Hwang</title> <meta name="author" content="Hye Won (Nicole) Hwang"> <meta name="description" content="Building a Machine Learning Pipeline for Fraud Detection"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://hyeniii.github.io/projects/1_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Hye Won (Nicole) Hwang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Fraud detection model pipeline</h1> <p class="post-description">Building a Machine Learning Pipeline for Fraud Detection</p> </header> <article> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/12-480.webp 480w, /assets/img/12-800.webp 800w, /assets/img/12-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/12.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="credit card fraud image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h2 id="introduction">Introduction</h2> <p>This project develops a flexible machine learning pipeline tailored for detecting credit card fraud. Its core feature is the ability to train various models through configurable YAML files, allowing users to test different approaches easily. Integrated with MLflow, the pipeline tracks and manages training experiments, aiding in the comparison and evaluation of diverse models.</p> <p>A significant aspect of this pipeline is its capability to handle imbalanced data, a common challenge in fraud detection. Users can experiment with different sampling methods to balance the dataset, ensuring more accurate and reliable model performance. This flexibility, combined with comprehensive experiment tracking, positions the pipeline as a versatile tool in the fight against credit card fraud.</p> <h2 id="project-setup">Project setup</h2> <p>The project uses a variety of tools and libraries, including</p> <ul> <li>pandas for data manipulation,</li> <li>scikit-learn for machine learning,</li> <li>MLflow for experiment tracking,</li> <li>joblib for model serialization</li> </ul> <p>The configuration is managed using YAML files, offering a flexible and dynamic way to handle various parameters.</p> <p>Here is an example of the config yaml file…</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">experiment_name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">RandomForestClassifier</span><span class="nv"> </span><span class="s">hp</span><span class="nv"> </span><span class="s">tuning"</span>
<span class="na">data_path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">data/creditcard.csv"</span>
<span class="na">target</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Class"</span>

<span class="na">model</span><span class="pi">:</span>
  <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">RandomForestClassifier"</span>
  <span class="na">module</span><span class="pi">:</span> <span class="s2">"</span><span class="s">sklearn.ensemble"</span>
  <span class="na">params</span><span class="pi">:</span>
    <span class="na">n_estimators</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">100</span><span class="pi">,</span> <span class="nv">500</span><span class="pi">]</span>
    <span class="na">max_depth</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">10</span><span class="pi">,</span> <span class="nv">50</span><span class="pi">]</span>
  <span class="na">save_path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">artifacts/model/rf_model.joblib"</span>

<span class="na">preprocessing</span><span class="pi">:</span>
  <span class="na">sampler</span><span class="pi">:</span>
    <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">RandomOverSampler"</span>
    <span class="na">module</span><span class="pi">:</span> <span class="s2">"</span><span class="s">imblearn.over_sampling"</span>
  <span class="na">scaler</span><span class="pi">:</span>
    <span class="na">class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">StandardScaler"</span>
    <span class="na">module</span><span class="pi">:</span> <span class="s2">"</span><span class="s">sklearn.preprocessing"</span>
</code></pre></div></div> <p>Experimenter can simply change preprocessing and modeling methods by changing the corresponding methods in the config file and run the experiment.</p> <h3 id="imbalance-in-dataset-strategies-and-considerations">Imbalance in Dataset: Strategies and Considerations</h3> <div class="col-sm-5 mt-3 mt-md-0" style="float: left; margin-right: 20px;"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/imbalance-480.webp 480w, /assets/img/imbalance-800.webp 800w, /assets/img/imbalance-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/imbalance.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>In machine learning, especially in problems like credit card fraud detection, class imbalance poses a significant challenge. The imbalance occurs when one class (e.g., fraudulent transactions) is vastly outnumbered by another (e.g., legitimate transactions). This imbalance can lead to models that are biased towards the majority class, often at the expense of poorly predicting the minority class, which is usually the class of interest.</p> <h5 id="strategies-for-handling-imbalance">Strategies for Handling Imbalance</h5> <ul> <li> <p><strong>Class Weights</strong>: For models that support the class_weight parameter (such as many in scikit-learn), assigning a higher weight to the minority class helps counterbalance its underrepresentation. In our pipeline, we’ve integrated <code class="language-plaintext highlighter-rouge">class_weight='balanced'</code> for such models. This approach effectively tells the model to “pay more attention” to the minority class, which is crucial in fraud detection where failing to detect fraud (a false negative) can be very costly.</p> </li> <li> <p><strong>Sampling Methods</strong>: When class weights are not an option, or to explore different approaches, we can use sampling methods. These methods adjust the dataset before training the model. We’ve provided options for:</p> <ul> <li> <strong>Undersampling</strong>: Reducing the number of instances in the majority class.</li> <li> <strong>Oversampling</strong>: Increasing the number of instances in the minority class.</li> <li> <strong>SMOTE (Synthetic Minority Over-sampling Technique)</strong>: Creating synthetic instances of the minority class.</li> </ul> </li> </ul> <h5 id="the-debate-around-smote">The Debate Around SMOTE</h5> <p>While SMOTE is a popular and powerful method to handle imbalanced datasets, it’s not without its critics. Some concerns include:</p> <ul> <li> <p><strong>Distorted Data Space</strong>: Synthetic points generated by SMOTE may not represent the true data distribution, potentially leading the model to learn incorrect patterns.</p> </li> <li> <p><strong>Noise</strong>: If the minority class has outliers, SMOTE may amplify these outliers by creating more synthetic instances around them.</p> </li> </ul> <h3 id="results-and-comparisons">Results and Comparisons</h3> <h4 id="roc-curves-and-recall-comparisons">ROC Curves and Recall Comparisons</h4> <p>[Include ROC curve plots and recall values]</p> <h4 id="precision-recall-curves">Precision-Recall Curves</h4> <p>[Include precision-recall curve plots]</p> <h4 id="confusion-matrices">Confusion Matrices</h4> <p>[Present confusion matrices for each model]</p> <h4 id="f1-scores-and-auc">F1 Scores and AUC</h4> <p>[Table or chart comparing F1 scores and AUC values]</p> <h4 id="model-efficiency">Model Efficiency</h4> <p>[Discuss training and prediction times]</p> <h4 id="feature-importance-analysis">Feature Importance Analysis</h4> <p>[Insights from feature importance, if applicable]</p> <h4 id="summary-table">Summary Table</h4> <p>[A comprehensive table summarizing all key metrics for each model]</p> <h4 id="discussion-of-results">Discussion of Results</h4> <p>[Interpretation and insights from the above analyses]</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Hye Won (Nicole) Hwang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>